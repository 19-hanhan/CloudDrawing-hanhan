<template>
    <div class="new_weibo_middle">
        <div id="top_block"></div>
        <div class="container">
            <div class="col-md-2">
                <Middle_Left/>
            </div>
            <div class="col-md-7">
                <div class="new_weibo">
                    <div id="new_weibo_top" class="clearfix">
                        <span>Êúâ‰ªÄ‰πàÊñ∞È≤ú‰∫ãÊÉ≥ÂëäËØâÂ§ßÂÆ∂Ôºü</span>
                    </div>
                    <div id="new_weibo_middle">
                        <el-input
                                id="ipt"
                                ref="weibo"
                                type="textarea"
                                :autosize="{ minRows: 3}"
                                placeholder=""
                                v-model="textarea"
                                maxlength="500"
                                show-word-limit
                                resize="none">
                        </el-input>
                    </div>
                    <div id="new_weibo_bottom" class="clearfix">
                        <div class="bottom_left clearfix">
                            <el-popover
                                    popper-class="biaoqing"
                                    placement="bottom-start"
                                    title=""
                                    width="200"
                                    trigger="click">
                                <div class="faces">
                                    <ul>
                                        <li title="ÂæÆÁ¨ë" @click="input_faces($event)">
                                            <img
                                                    src="https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/e3/2018new_weixioa02_org.png">
                                        </li>
                                        <li title="ÂèØÁà±" @click="input_faces($event)">
                                            <img src="https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/09/2018new_keai_org.png">
                                        </li>
                                        <li title="Â§™ÂºÄÂøÉ" @click="input_faces($event)">
                                            <img
                                                    src="https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/1e/2018new_taikaixin_org.png">
                                        </li>
                                        <li title="ÈºìÊéå" @click="input_faces($event)">
                                            <img
                                                    src="https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/6e/2018new_guzhang_thumb.png">
                                        </li>
                                        <li title="ÂòªÂòª" @click="input_faces($event)">
                                            <img src="https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/33/2018new_xixi_thumb.png">
                                        </li>
                                        <li title="ÂìàÂìà" @click="input_faces($event)">
                                            <img src="https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/8f/2018new_haha_thumb.png">
                                        </li>
                                        <li title="Á¨ëcry" @click="input_faces($event)">
                                            <img src="https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/4a/2018new_xiaoku_thumb.png">
                                        </li>
                                        <li title="Êå§Áúº" @click="input_faces($event)">
                                            <img src="https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/43/2018new_jiyan_org.png">
                                        </li>
                                        <li title="È¶ãÂò¥" @click="input_faces($event)">
                                            <img src="https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/fa/2018new_chanzui_org.png">
                                        </li>
                                        <li title="ÈªëÁ∫ø" @click="input_faces($event)">
                                            <img
                                                    src="https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/a3/2018new_heixian_thumb.png">
                                        </li>
                                        <li title="Ê±ó" @click="input_faces($event)">
                                            <img src="https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/28/2018new_han_org.png">
                                        </li>
                                        <li title="ÊåñÈºª" @click="input_faces($event)">
                                            <img src="https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/9a/2018new_wabi_thumb.png">
                                        </li>
                                        <li title="Âìº" @click="input_faces($event)">
                                            <img src="https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/7c/2018new_heng_thumb.png">
                                        </li>
                                        <li title="ÊÄí" @click="input_faces($event)">
                                            <img src="https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/f6/2018new_nu_thumb.png">
                                        </li>
                                        <li title="ÂßîÂ±à" @click="input_faces($event)">
                                            <img src="https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/a5/2018new_weiqu_thumb.png">
                                        </li>
                                        <li title="ÂèØÊÄú" @click="input_faces($event)">
                                            <img src="https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/96/2018new_kelian_org.png">
                                        </li>
                                        <li title="Â§±Êúõ" @click="input_faces($event)">
                                            <img
                                                    src="https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/aa/2018new_shiwang_thumb.png">
                                        </li>
                                        <li title="ÊÇ≤‰º§" @click="input_faces($event)">
                                            <img src="https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/ee/2018new_beishang_org.png">
                                        </li>
                                        <li title="Ê≥™" @click="input_faces($event)">
                                            <img src="https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/6e/2018new_leimu_org.png">
                                        </li>
                                        <li title="ÂÖÅÊÇ≤" @click="input_faces($event)">
                                            <img src="https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/83/2018new_kuxiao_org.png">
                                        </li>
                                        <li title="ÂÆ≥Áæû" @click="input_faces($event)">
                                            <img src="https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/c1/2018new_haixiu_org.png">
                                        </li>
                                        <li title="Ê±°" @click="input_faces($event)">
                                            <img src="https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/10/2018new_wu_thumb.png">
                                        </li>
                                        <li title="Áà±‰Ω†" @click="input_faces($event)">
                                            <img src="https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/f6/2018new_aini_org.png">
                                        </li>
                                        <li title="‰∫≤‰∫≤" @click="input_faces($event)">
                                            <img src="https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/2c/2018new_qinqin_thumb.png">
                                        </li>
                                        <li title="Ëâ≤" @click="input_faces($event)">
                                            <img src="https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/9d/2018new_huaxin_org.png">
                                        </li>
                                        <li title="ÊÜßÊÜ¨" @click="input_faces($event)">
                                            <img
                                                    src="https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/c9/2018new_chongjing_org.png">
                                        </li>
                                        <li title="ËàîÂ±è" @click="input_faces($event)">
                                            <img
                                                    src="https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/3e/2018new_tianping_thumb.png">
                                        </li>
                                        <li title="ÂùèÁ¨ë" @click="input_faces($event)">
                                            <img src="https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/4d/2018new_huaixiao_org.png">
                                        </li>
                                        <li title="Èò¥Èô©" @click="input_faces($event)">
                                            <img src="https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/9e/2018new_yinxian_org.png">
                                        </li>
                                        <li title="Á¨ëËÄå‰∏çËØ≠" @click="input_faces($event)">
                                            <img
                                                    src="https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/2d/2018new_xiaoerbuyu_org.png">
                                        </li>
                                        <li title="ÂÅ∑Á¨ë" @click="input_faces($event)">
                                            <img src="https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/71/2018new_touxiao_org.png">
                                        </li>
                                        <li title="ÈÖ∑" @click="input_faces($event)">
                                            <img src="https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/c4/2018new_ku_org.png">
                                        </li>
                                        <li title="Âπ∂‰∏çÁÆÄÂçï" @click="input_faces($event)">
                                            <img
                                                    src="https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/aa/2018new_bingbujiandan_thumb.png">
                                        </li>
                                        <li title="ÊÄùËÄÉ" @click="input_faces($event)">
                                            <img src="https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/30/2018new_sikao_org.png">
                                        </li>
                                        <li title="ÁñëÈóÆ" @click="input_faces($event)">
                                            <img src="https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/b8/2018new_ningwen_org.png">
                                        </li>
                                        <li title="Ë¥πËß£" @click="input_faces($event)">
                                            <img src="https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/2a/2018new_wenhao_thumb.png">
                                        </li>
                                        <li title="Êôï" @click="input_faces($event)">
                                            <img src="https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/07/2018new_yun_thumb.png">
                                        </li>
                                        <li title="Ë°∞" @click="input_faces($event)">
                                            <img src="https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/a2/2018new_shuai_thumb.png">
                                        </li>
                                        <li title="È™∑È´Ö" @click="input_faces($event)">
                                            <img src="https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/a1/2018new_kulou_thumb.png">
                                        </li>
                                        <li title="Âòò" @click="input_faces($event)">
                                            <img src="https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/b0/2018new_xu_org.png">
                                        </li>
                                        <li title="Èó≠Âò¥" @click="input_faces($event)">
                                            <img src="https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/62/2018new_bizui_org.png">
                                        </li>
                                        <li title="ÂÇªÁúº" @click="input_faces($event)">
                                            <img src="https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/dd/2018new_shayan_org.png">
                                        </li>
                                        <li title="ÂêÉÊÉä" @click="input_faces($event)">
                                            <img src="https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/49/2018new_chijing_org.png">
                                        </li>
                                        <li title="Âêê" @click="input_faces($event)">
                                            <img src="https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/08/2018new_tu_org.png">
                                        </li>
                                        <li title="ÊÑüÂÜí" @click="input_faces($event)">
                                            <img
                                                    src="https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/40/2018new_kouzhao_thumb.png">
                                        </li>
                                        <li title="ÁîüÁóÖ" @click="input_faces($event)">
                                            <img
                                                    src="https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/3b/2018new_shengbing_thumb.png">
                                        </li>
                                        <li title="ÊãúÊãú" @click="input_faces($event)">
                                            <img src="https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/fd/2018new_baibai_thumb.png">
                                        </li>
                                        <li title="ÈÑôËßÜ" @click="input_faces($event)">
                                            <img src="https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/da/2018new_bishi_org.png">
                                        </li>
                                        <li title="ÁôΩÁúº" @click="input_faces($event)">
                                            <img
                                                    src="https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/ef/2018new_landelini_org.png">
                                        </li>
                                        <li title="Â∑¶ÂìºÂìº" @click="input_faces($event)">
                                            <img
                                                    src="https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/43/2018new_zuohengheng_thumb.png">
                                        </li>
                                        <li title="Âè≥ÂìºÂìº" @click="input_faces($event)">
                                            <img
                                                    src="https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/c1/2018new_youhengheng_thumb.png">
                                        </li>
                                        <li title="ÊäìÁãÇ" @click="input_faces($event)">
                                            <img
                                                    src="https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/17/2018new_zhuakuang_org.png">
                                        </li>
                                        <li title="ÊÄíÈ™Ç" @click="input_faces($event)">
                                            <img src="https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/87/2018new_zhouma_thumb.png">
                                        </li>
                                        <li title="ÊâìËÑ∏" @click="input_faces($event)">
                                            <img src="https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/cb/2018new_dalian_org.png">
                                        </li>
                                        <li title="È°∂" @click="input_faces($event)">
                                            <img src="https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/ae/2018new_ding_org.png">
                                        </li>
                                        <li title="‰∫íÁ≤â" @click="input_faces($event)">
                                            <img src="https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/86/2018new_hufen02_org.png">
                                        </li>
                                        <li title="Èí±" @click="input_faces($event)">
                                            <img src="https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/a2/2018new_qian_thumb.png">
                                        </li>
                                        <li title="ÂìàÊ¨†" @click="input_faces($event)">
                                            <img src="https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/55/2018new_dahaqian_org.png">
                                        </li>
                                        <li title="Âõ∞" @click="input_faces($event)">
                                            <img src="https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/3c/2018new_kun_thumb.png">
                                        </li>
                                        <li title="Áù°" @click="input_faces($event)">
                                            <img
                                                    src="https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/e2/2018new_shuijiao_thumb.png">
                                        </li>
                                        <li title="Ê±ÇÈ•∂" @click="input_faces($event)">
                                            <img src="https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/aa/moren_qiurao02_thumb.png">
                                        </li>
                                        <li title="ÂêÉÁìú" @click="input_faces($event)">
                                            <img src="https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/01/2018new_chigua_thumb.png">
                                        </li>
                                        <li title="Êâìcall" @click="input_faces($event)">
                                            <img src="https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/39/moren_dacall02_thumb.png">
                                        </li>
                                        <li title="awsl" @click="input_faces($event)">
                                            <img src="https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/14/moren_awsl02_thumb.png">
                                        </li>
                                        <li title="Ëã¶Ê∂©" @click="input_faces($event)">
                                            <img src="https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/7e/2021_bitter_thumb.png">
                                        </li>
                                        <li title="Ë£ÇÂºÄ" @click="input_faces($event)">
                                            <img src="https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/1b/202011_liekai_thumb.png">
                                        </li>
                                        <li title="doge" @click="input_faces($event)">
                                            <img src="https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/a1/2018new_doge02_org.png">
                                        </li>
                                        <li title="‰∫åÂìà" @click="input_faces($event)">
                                            <img src="https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/22/2018new_erha_org.png">
                                        </li>
                                        <li title="ÂñµÂñµ" @click="input_faces($event)">
                                            <img
                                                    src="https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/7b/2018new_miaomiao_thumb.png">
                                        </li>
                                        <li title="ÈÖ∏" @click="input_faces($event)">
                                            <img src="https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/b3/hot_wosuanle_thumb.png">
                                        </li>
                                        <li title="‰∏≠ÂõΩËµû" @click="input_faces($event)">
                                            <img
                                                    src="https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/6d/2018new_zhongguozan_org.png">
                                        </li>
                                        <li title="Êä±Êä±" @click="input_faces($event)">
                                            <img src="https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/42/2018new_baobao_thumb.png">
                                        </li>
                                        <li title="ÊëäÊâã" @click="input_faces($event)">
                                            <img src="https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/62/2018new_tanshou_org.png">
                                        </li>
                                        <li title="Ë∑™‰∫Ü" @click="input_faces($event)">
                                            <img src="https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/75/2018new_gui_org.png">
                                        </li>
                                        <li title="È≤úËä±" @click="input_faces($event)">
                                            <img src="https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/d4/2018new_xianhua_org.png">
                                        </li>
                                        <li title="Á∫¢ÁÅØÁ¨º" @click="input_faces($event)">
                                            <img src="https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/e8/2021_lantern_thumb.png">
                                        </li>
                                        <li title="ÁÉüËä±" @click="input_faces($event)">
                                            <img src="https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/96/2021_fireworks_thumb.png">
                                        </li>
                                        <li title="Èõ™Ëä±" @click="input_faces($event)">
                                            <img
                                                    src="https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/13/yunying2020_snowflakes_thumb.png">
                                        </li>
                                        <li title="‰∏òÊØîÁâπ" @click="input_faces($event)">
                                            <img src="https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/45/2021_qiubite_thumb.png">
                                        </li>
                                        <li title="ÂçïË∫´Áãó" @click="input_faces($event)">
                                            <img src="https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/20/2021_alongdog_thumb.png">
                                        </li>
                                        <li title="Êä±‰∏ÄÊä±" @click="input_faces($event)">
                                            <img src="https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/af/2020_hug_thumb.png">
                                        </li>
                                        <li title="Â∞è‰∏ë" @click="input_faces($event)">
                                            <img src="https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/6f/2021_xiaochou_thumb.png">
                                        </li>
                                        <li title="Êù∞Áëû" @click="input_faces($event)">
                                            <img src="https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/da/2021_jerry_thumb.png">
                                        </li>
                                        <li title="Ê±§ÂßÜ" @click="input_faces($event)">
                                            <img src="https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/31/2021_tom_thumb.png">
                                        </li>
                                        <li title="Â•∂Áì∂" @click="input_faces($event)">
                                            <img src="https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/8c/2021_naiping_thumb.png">
                                        </li>
                                    </ul>
                                </div>
                                <el-button slot="reference">üòä Ë°®ÊÉÖ</el-button>
                            </el-popover>
                        </div>
                        <div class="bottom_right clearfix">
                            <el-button type="warning" size="small" :disabled="!textarea" @click="post_on">ÂèëÂ∏É</el-button>
                        </div>
                    </div>
                </div>
                <div class="upload_picture clearfix">
                    <p>‰∏ä‰º†ÁÖßÁâá</p>
                    <div class="pic clearfix">
                        <el-upload
                                id="ipt-pic"
                                class="upload-demo"
                                action=""
                                multiple
                                accept="image/gif, image/jpeg, image/jpg, image/png"
                                :limit="9"
                                :on-exceed="handleExceed"
                                :auto-upload="false"
                                :before-remove="beforeRemove"
                                :on-remove="handleRemove"
                                :on-change="handleChange"
                                :file-list="fileList"
                                list-type="picture">
                            <el-button size="small" type="primary">ÈÄâÊã©ÂõæÁâá</el-button>
                            <div slot="tip" class="el-upload__tip">ÊúÄÂ§ö‰∏ä‰º† 9 Âº†ÂõæÁâá</div>
                        </el-upload>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <Middle_Right/>
            </div>
        </div>
    </div>
</template>

<script>
    import Middle_Left from "./Middle_Left";
    import Middle_Right from "./Middle_Right";
    import qs from "qs";

    export default {
        name: "New_Weibo_Middle",
        components: {
            Middle_Left,
            Middle_Right
        },
        data() {
            return {
                textarea: '',
                fileList: [],
                token: this.$cookies.get('token'),
            }
        },
        methods: {
            // ÁÇπÂáªË°®ÊÉÖÊó∂
            input_faces(e) {
                let text = document.getElementById('ipt').value;
                let faces_name = '[' + e.currentTarget.getAttribute('title') + ']';
                if (text.length + faces_name.length <= 500) {
                    this.insertInputTxt('ipt', faces_name);
                    this.textarea = document.getElementById('ipt').value
                }
            },
            // Â∞ÜË°®ÊÉÖÂØπÂ∫îÁöÑÂêçÁß∞ËæìÂÖ• input Ê°Ü‰∏≠
            insertInputTxt(id, insertTxt) {
                let elInput = document.getElementById(id); // Ëé∑Âèñdom
                let startPos = elInput.selectionStart;
                let endPos = elInput.selectionEnd;
                if (startPos === undefined || endPos === undefined) return;
                let txt = elInput.value;
                let result = txt.substring(0, startPos) + insertTxt + txt.substring(endPos);
                elInput.value = result;
                // ËøôÈáåÊØîËæÉÈáçË¶Å **ÁªôÊúÄÁªàÁªëÂÆöÁöÑÂèÇÊï∞ ËøõË°åËµãÂÄº
                this.ipt = result; // ËµãÂÄº
                elInput.focus();
                this.$nextTick(() => {
                    elInput.selectionStart = startPos + insertTxt.length;
                    elInput.selectionEnd = startPos + insertTxt.length;
                });
            },

            // Êñá‰ª∂Áä∂ÊÄÅÊîπÂèòÊó∂
            handleChange(file, fileList) {
                this.fileList = fileList
            },

            // ÁßªÈô§ÂõæÁâáÊñá‰ª∂Êó∂
            handleRemove(file, fileList) {
                this.fileList = fileList
            },

            // Ë∂ÖÂá∫‰∏ä‰º†ÈôêÂà∂Êó∂ÁöÑÊèêÈÜí
            handleExceed() {
                this.$message.warning(`ÊúÄÂ§öÂè™ËÉΩ‰∏ä‰º† 9 Âº†ÂõæÁâá`);
            },

            // ÁßªÈô§ÂõæÁâáÊñá‰ª∂Ââç
            beforeRemove(file) {
                return this.$confirm(`Á°ÆÂÆöÁßªÈô§ ${file.name}Ôºü`);
            },

            // ÁÇπÂáªÂèëÂ∏ÉÊåâÈíÆÂèëÂ∏ÉÂæÆÂçö
            post_on() {
                if (!this.token) {
                    this.$message({
                        message: 'ËØ∑ÂÖàÁôªÂΩï',
                        type: 'warning',
                        center: true
                    });
                    this.$router.push('/')
                } else {
                    console.log(this.fileList)
                    if (/*this.fileList.length === 0*/ false) {  // Âè™ÊúâÊñáÂ≠óÊ≤°ÊúâÂõæÁâáÁöÑÊÉÖÂÜµ
                        console.log(this.userId)
                        console.log(this.textarea)
                        this.$axios({
                            method: 'post',
                            url: '/api/diary/add_diary',
                            headers: {Authorization: this.token},
                            data: qs.stringify({
                                userId: this.userId,
                                content: this.textarea,
                            }),
                        }).then(response => {
                            if (response.data.code === 200) {
                                console.log(response.data.result)
                                this.$message({
                                    message: 'ÂèëÂ∏ÉÊàêÂäü',
                                    type: 'success',
                                    center: true
                                });
                            } else {
                                console.log(response.data.result)
                                this.$message({
                                    message: 'ÂèëÂ∏ÉÂ§±Ë¥•',
                                    type: 'error',
                                    center: true
                                });
                            }
                            this.textarea = ''
                            this.fileList = []
                        }).catch(errors => {
                            this.$message({
                                message: 'Êú™Áü•ÈîôËØØÔºåËØ∑ÈáçËØï',
                                type: 'error',
                                center: true
                            });
                        })
                    } else {  // ÊñáÂ≠óÂíåÂõæÁâáÈÉΩÊúâÁöÑÊÉÖÂÜµ
                        try {
                            // ÂàõÂª∫‰∏Ä‰∏™Á©∫ÁöÑFormDataÂØπË±°:
                            const formData = new FormData()
                            this.fileList.forEach((file) => {
                                // const isIMAGE = file.type === 'image/gif' || 'image/jpeg' || 'image/jpg' || 'image/bmp' || 'image/png';
                                const isIMAGE = file.type === 'image/gif' || 'image/jpeg' || 'image/jpg' || 'image/png';
                                const isLt5M = file.size / 1024 / 1024 < 5;
                                if (!isIMAGE) {
                                    this.$message({
                                        message: '‰∏ä‰º†ÂõæÁâáÂè™ËÉΩÊòØÂõæÁâáÊ†ºÂºè',
                                        type: 'error',
                                        center: true
                                    });
                                    throw new Error('EndIterative');  // ÁªìÊùüÊï¥‰ΩìÂæ™ÁéØ
                                }
                                if (!isLt5M) {
                                    this.$message({
                                        message: 'ÂçïÂº†ÂõæÁâáÂ§ßÂ∞è‰∏çËÉΩË∂ÖËøá 5MBÔºÅ',
                                        type: 'warning',
                                        center: true
                                    });
                                    throw new Error('EndIterative');  // ÁªìÊùüÊï¥‰ΩìÂæ™ÁéØ
                                }
                                // ‰ΩøÁî®FormData.appendÊù•Ê∑ªÂä†ÈîÆ/ÂÄºÂØπÂà∞Ë°®ÂçïÈáåÈù¢
                                formData.append('imgs', file.raw)
                            })
                            formData.append('userId', this.userId)
                            formData.append('content', this.textarea)
                            this.$axios({
                                method: 'post',
                                url: '/api/diary/add_diary',
                                headers: {Authorization: this.token},
                                data: formData
                            }).then(response => {
                                if (response.data.code === 200) {
                                    this.$message({
                                        message: 'ÂèëÂ∏ÉÊàêÂäü',
                                        type: 'success',
                                        center: true
                                    });
                                } else {
                                    this.$message({
                                        message: 'ÂèëÂ∏ÉÂ§±Ë¥•',
                                        type: 'error',
                                        center: true
                                    });
                                }
                                this.textarea = ''
                                this.fileList = []
                            }).catch(errors => {
                                this.$message({
                                    message: 'Êú™Áü•ÈîôËØØÔºåËØ∑ÈáçËØï',
                                    type: 'error',
                                    center: true
                                });
                            })
                        } catch (e) {
                        }
                    }
                }

            }
        },

        computed: {
            userId() {
                return this.$store.state.id
            }
        }
    }
</script>


<style scoped>

    .clearfix:after { /*ÂÖ∑ÊúâclearfixÁ±ªÂ±ûÊÄßÁöÑÊ†áÁ≠æÂêéÈù¢Ê∑ªÂä†*/
        content: ''; /*Ê∑ªÂä†ÁöÑÂÜÖÂÆπ‰∏∫Á©∫*/
        display: block; /*ËÆ©Á©∫ÂÜÖÂÆπÂÖ∑ÊúâÂùóÁ∫ßÊ†áÁ≠æÁöÑÂ±ûÊÄßÔºöÁã¨Âç†‰∏ÄË°å*/
        clear: both; /*Á©∫ÂÜÖÂÆπÂ∑¶Âè≥‰∏§‰æß‰∏çËÉΩÊúâÊµÆÂä®ÁöÑÊ†áÁ≠æ*/
    }

    #top_block {
        margin-top: 5em;
    }

    .container {
        min-height: 1177px;
    }

    .new_weibo {
        background-color: #f5f5f5;
    }

    #new_weibo_top {
        padding-top: 10px;
        padding-bottom: 10px;
    }

    #new_weibo_top span {
        float: left;
        padding-left: 2%;
    }

    .el-textarea {
        width: 96%;
        margin-bottom: 5px;
    }

    .el-button.el-button--default.el-popover__reference {
        border-left-width: 0;
        float: left;
        border-top-width: 0;
        border-right-width: 0;
        border-bottom-width: 0;
        background-color: #f5f5f5;
        padding-right: 0;
    }

    .faces ul {
        list-style: none;
        display: block;
    }

    .faces ul li {
        cursor: pointer;
        float: left;
        border: 1px solid #e8e8e8;
        height: 35px;
        width: 35px;
        overflow: hidden;
        margin: -1px 0 0 -1px;
        padding: 6px 4px;
        text-align: center;
        display: list-item;
    }

    .faces ul li:hover {
        background-color: #e8e8e8;
    }

    .faces ul li img {
        width: 22px;
        height: 22px;
    }

    .bottom_left {
        float: left;
    }

    .bottom_right {
        float: right;
        margin-right: 3%;
        margin-bottom: 10px;
    }

    .upload_picture.clearfix {
        padding-top: 25px;
    }

    .upload_picture p {
        text-align: left;
        background-color: rgb(245, 245, 245);
        padding: 10px 2%;
    }

    .pic.clearfix {
        background-color: #f5f5f5;
        padding-left: 2%;
        padding-right: 2%;
    }

    #ipt-pic {
        padding-bottom: 10px;
    }

    .col-md-3 {
        padding-right: 0;
        padding-left: 0;
    }

    @media screen and (max-width: 1200px) {
        .col-md-2 {
            display: none;
        }

        .col-md-3 {
            display: none;
        }

        .bottom_right {
            margin-right: 2%;
        }
    }

    @media screen and (max-width: 765px) {
        .container {
            padding-left: 0;
            padding-right: 0;
        }
    }
</style>
